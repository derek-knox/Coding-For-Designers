<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Coding and Concept</title>
    <meta name="description" content="...">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,900" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/prism.css">
  </head>
  <body>
    
    <header>
      <p>
        <a href="/preface">Ch0</a>
        <a href="/breaking-barriers">Ch1</a>
        <a href="/structure-style-and-behavior">Ch2</a>
        <a href="/coding-and-visual-design">Ch3</a>
        <a href="/coding-and-concept">Ch4</a>
        <a href="/coding-and-javascript">Ch5</a>
        <a href="/deconstructing-designs">Ch6</a>      </p>
    </header>

    <section>
      <div class='content-text'>
        <h1 class='chapter-title'>Coding and Concept</h1>
      </div>
      <div class='content-text'>
        <h2 id="sync-and-async">Sync and Async</h2>
<p>Though we didn&apos;t explicitly state it, the nature of how the event loop works gives rise to the notion of <em>sync</em> and <em>async</em> work. Synchronous and asynchronous are the full terms, but we will use the shortcuts sync and async instead.</p>
<p>Sync work is referred to as <em>blocking</em> where async work is <em>non-blocking</em>. Using your new knowledge of the event loop, how would you categorize the engine&apos;s stack work? How about the runtime APIs work? I&apos;ll give you a clue, they are different. Take a moment before continuing.</p>
<p>Answer time:</p>
</div><div id="todo---replace" class="content-visual"><figure><img src="../assets/img/visual-todo-placeholder.jpg" alt="TODO - Replace" title="TODO - Replace"><figcaption>TODO - Replace</figcaption></figure></div><div class="content-text">
<table>
  <tr>
    <td>sync</td>
    <td>blocking</td>
    <td>stack work</td>
  </tr>
  <tr>
    <td>async</td>
    <td>non-blocking</td>
    <td>runtime APIs work</td>
  </tr>
</table>

<p>The Event Loop Machine 3D visualization from the <em>Event Loop</em> section should be popping into your head. The event loop cannot cycle when work is on the stack. The loop is blocked. The event queue does not prevent the event loop from cycling. The loop is not blocked.</p>
<p>Let&apos;s look at code examples of both work types to see this in action. We haven&apos;t specifically covered JavaScript outside the <em>Elements and Elements</em> section yet, but I am confident you&apos;ll get the gist.</p>
<p>Sync work:</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">makeBackgroundBlack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&apos;#000000&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">makeBackgroundBlack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="content-text">
<p>There are likely some details you don&apos;t understand, but that is to be expected. Let&apos;s look at the same code with some added explanations. Take note that the words following the <code>//</code> are plain English, not code. These plain English <em>comments</em> are useful for us humans when we read and share our code for others to read (including our future self). Comments are for humans not computers. The engine essentially ignores them.</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token comment">// 1. We declare a function statement (stack work) for the engine</span>
<span class="token comment">// 2. We name the function whatever we want, &apos;makeBackgroundBlack&apos; in this case</span>
<span class="token comment">// 3. The engine doesn&apos;t do the work yet (code statement between the &apos;{&apos; and &apos;}&apos;)</span>
<span class="token keyword">function</span> <span class="token function">makeBackgroundBlack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// We set the document&apos;s background color to black (remember the Coding Color section?)</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&apos;#000000&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 1. We tell the engine to do work, the code sequence `();` is the trigger</span>
<span class="token comment">// 2. Since we named the function, the engine knows the exact work to put on its stack</span>
<span class="token function">makeBackgroundBlack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="content-text">
<p>Without comments, there are naturally a lot less lines for us humans to read. As far as the engine is concerned however, these are the same program. As you gain more experience you will understand when and when not to use comments. When in doubt use them to help other coders, including your future self, understand your original intention.</p>
<p>Admittedly, the code above does not do a whole lot. The work inside of the <code>makeBackgroundBlack</code> function will happen really fast too. The event loop will technically be blocked for less than 1ms, but from a user&apos;s perspective the work will happen instantly and then the event loop will become unblocked. If the function instead counted to a million before changing the background color, then the user would percieve the program as slower (and rightly so).</p>
<p>The takeaway here is that you should try to do small and efficient work in your functions. As you author code over time, you will develop an intuitive understanding of what that really means. For now, put this idea in the back of your mind. Remember, the faster the stack and event queue are cleared, the greater the chance you will hit your target frame rate. 60fps? Yes please.</p>
<p>Let&apos;s now look at an async example. We will make it similar to the sync example for comparison. In fact, we will make the program identical except for a single statement and its comments.</p>
<p>Async work:</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">makeBackgroundBlack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&apos;#000000&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 1. We tell the engine to do work, the code sequence `(makeBackgroundBlack, 1000);` is the trigger</span>
<span class="token comment">// 2. &apos;setTimeout&apos; is a named built-in function that the &apos;runtime APIs&apos; provide, thank you runtime</span>
<span class="token comment">// 3. The &apos;setTimeout&apos; function expects two argument values</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>makeBackgroundBlack<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="content-text">
<p>Before reading on, try to guess what <code>setTimeout</code> does. How do you think it uses the argument values?</p>
<p>This async program is identical to the sync program except for one code statement. If we look up how the <code>setTimeout</code> function uses its arguments to do work, we can learn what work it does. I want to stress again that professional coders, just like beginners, use references to learn and remind themselves what certain functions do. Even the best cannot remember everything.</p>
<p>I will just tell you what arguments, in order, <code>setTimeout</code> expects:</p>
<ol>
<li>a function</li>
<li>a time in milliseconds</li>
</ol>
<p>The work <code>setTimout</code> actually does, in English, is:</p>
<ol>
<li>create a timer</li>
<li>run the timer for the time in milliseconds provided</li>
<li>wait for the timer to complete</li>
<li>upon completion, update the event queue with the function provided</li>
</ol>
<p>What is cool about many functions, <code>setTimeout</code> included, is that they can be designed with a small amount of flexibility built-in. As you may have guessed, as long as we give <code>setTimeout</code> valid arguments, it will always do the work we want (via the function provided) after a delay (via the time provided). Pretty damn cool. You can design your own functions with flexibility as well.</p>
<p>As a quick example, let&apos;s design a new function named <code>changeBackgroundColor</code>.</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">changeBackgroundColor</span><span class="token punctuation">(</span>newColor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> newColor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="content-text">
<p>Here are a few examples of how we could use it:</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token function">changeBackgroundColor</span><span class="token punctuation">(</span><span class="token string">&apos;#FF0000&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="content-text">
<p>or</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token function">changeBackgroundColor</span><span class="token punctuation">(</span><span class="token string">&apos;Green&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="content-text">
<p>or</p>
</div><div class="content-code"><pre class="language-javascript line-numbers"><code class="language-javascript"><span class="token function">changeBackgroundColor</span><span class="token punctuation">(</span><span class="token string">&apos;Blue&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="content-text">
<p>You get the idea.</p>
<p>We explored some JavaScript a little bit in this section, but the main takeaway is the difference between sync and async. If you understand how to keep your stack work small and fast, you&apos;ll be running 60fps with no problem.</p>
<p>As you learn more about runtime APIs you will discover that the runtime will do a lot of really cool non-blocking work for you. If you haven&apos;t already noticed, the runtime APIs provide a simple <em>interface</em> for you as a code author to work with. Let&apos;s dig deeper into what that means.</p>

      </div>
    </section>

    <footer>
      <p>...</p>
    </footer>

    <script src="../assets/js/prism.js"></script>

  </body>
</html>
